// Assuming the rest of the code remains unchanged

const ip = request.headers.get('x-forwarded-for') || 'unknown';

// other code logic remains here...